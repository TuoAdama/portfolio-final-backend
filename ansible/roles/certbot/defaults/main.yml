certbot_email: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  64326361633433343162306534353535323238326266303434333636663863613636653632356661
  3265653933353738336437376132656465373561383339360a343837626261656530333462353331
  36313434373334613962643035643732353866643532356261613132313932663331666235393161
  3237656137366138660a373030333664316439373933346531613537636135376437623830643233
  30623864353064396362323433343366633966626661663865306332613138663965

keystore_pass: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  36623533393434383634623063613735656331623662393430376666383531653365333733366434
  6330353031353036613263323639633937643663633263310a623836336533623833333461366430
  65316462353634626530633466653132396263643466386636383931643334383166323434393661
  6439643966316638350a346162333263336331343232373837306635643761326238373136666266
  6466

mail_server_dns: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  62663662623730373734633637646536623063363435646431346265356633633262393266363034
  3061626666343236313433323731346265613935623362320a346165396238376237393439616234
  66666266646136306366623034393735336135643431636233663330346337343831386535663534
  6130373664363430310a336130323336633937336237383661323539373732636439363438396231
  38333966396636626264346262396562656631616163333237393239306365393134323061343732
  3532613565323562323736316633656633653237636265353964

mail_password: !vault |
  $ANSIBLE_VAULT;1.1;AES256
  66663131383033646132653333323361633836613432306338333135636239396262633030313631
  3261386532363032346466373663353734643063313130640a333633313038643564373066396335
  64376437316538316632393865303236303566316363373234653364313163393935376633393233
  3661323162636332620a366665346261386263323130373438613364363465663864613537323263
  3637

certbot_auto_renew: true
certbot_domain: "api-porfolio.tuo-adama.com"
mail_from: "noreply@api-porfolio.tuo-adama.com"


certificate_mail_path: "{{ current_project_folder }}/certificate_mail.txt"

certificate_path: "/etc/letsencrypt/live/{{ certbot_domain }}/fullchain.pem"

private_key: "/etc/letsencrypt/live/{{ certbot_domain }}/privkey.pem"

keystore_output: "{{ current_project_folder }}/src/main/resources/keystore.p12"

renew_certificate_cmd: "openssl pkcs12 -export -in {{ certificate_path }} -inkey {{ private_key }} -out {{ keystore_output }} -name portfolio   -CAfile {{ certificate_path }}  -caname root  -passout pass:{{ keystore_pass }}"

send_mail_cmd: "curl --url {{ mail_server_dns }} --ssl-reqd --mail-from {{ mail_from }} --mail-rcpt {{ certbot_email }} --upload-file {{ certificate_mail_path }} --user {{ mail_from }}:{{ mail_password }}"

certbot_standalone_post_hook_script: "{{ renew_certificate_cmd }} && {{ send_mail_cmd }}"
